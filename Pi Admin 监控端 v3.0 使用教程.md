# Pi Admin 监控端 v3.0 使用教程

  

## 1. 产品简介

**Pi Admin 监控端** 是一款专为 Pi Node 节点维护者设计的自动化监控工具。它运行在 Windows 节点机器上，通过智能 OCR（光学字符识别）技术和模拟操作，自动采集节点的运行状态（如算力、区块高度、版本号等），并实时上报到云端管理平台。

  

### 核心特性

- **非侵入式监控**：通过图像识别采集数据，不修改 Pi 客户端文件，安全可靠。

- **全自动运行**：自动检测登录状态、自动采集、自动重试。

- **会话守护 (Session Guardian)**：独家技术，完美解决 Windows 远程桌面断开后 OCR 失效的问题。

- **资源低占用**：经过优化的 Rust 原生代码，资源占用极低。

  

## 2. 安装与启动

  

### 2.1 系统要求

- **操作系统**: Windows 10 或 Windows 11 (64位)

- **依赖环境**:

  - 已安装 Pi Node (v0.4.5) 或 Pi Desktop (v0.5.4)

  - 建议安装 Microsoft YaHei (微软雅黑) 字体以获得最佳显示效果

  

### 2.2 获取与安装

本软件为绿色免安装版。

1. 下载最新的 `监控端.zip` 绿色免安装压缩包。

2. 将压缩包解压到一个固定目录（例如 `D:\PiMonitor`）。

   > **注意**: 请确保路径中不包含特殊字符，建议使用纯英文路径

  

### 2.3 目录结构说明

```text

PiMonitor/

├── data/                  # 存放用户配置文件 (自动生成)

├── config/                # 存放 OCR 校准文件

├── logs/                  # 运行日志目录

├── PiMonitorClient.exe    # 主程序

└── ...

```

  

### 2.4 首次启动

双击 `PiMonitorClient.exe` 即可启动程序。首次运行时，Windows Defender 或防火墙可能会提示网络访问请求，请点击“允许访问”。

  

## 3. 初始化配置

  

### 3.1 登录认证

启动后，你将看到登录界面。

1. **获取 Token**: 请在 Pi Admin 管理后台获取您的 **设备 Token**。

2. **选择版本**: 根据您当前运行的 Pi 客户端版本，选择 `v0.5.4 (Pi Desktop)` 或 `v0.4.5 (Pi Node)`。

   > **重要**: 版本选择错误会导致 OCR 识别位置偏移，无法采集数据。

3. **输入 Token**: 将 Token 粘贴到输入框中。

4. **连接服务器**: 点击按钮，验证通过后将进入监控仪表盘。

  

## 4. 监控仪表盘详解

  

### 4.1 顶部操作栏

- **启动/停止监控**: 控制自动化采集任务的开关。

- **设置**: 修改 API 地址、Token、采集间隔等参数。

- **会话守护**: 激活防锁屏模式（详见第 6 节）。

- **运行状态**: 右上角显示当前服务是否正在运行。

  

### 4.2 核心指标卡片

仪表盘实时显示采集到的数据：

- **节点名称**: 您的 Pi 节点名称。

- **算力**: 当前的总挖矿速率 (π/hr)。

- **区块高度**: 本地和最新区块高度。

- **外网 IP**: 节点的公网 IP 地址。

- **奖励**: 当前未领取的奖励估算值。

- **上次采集**: 最后一次成功上传数据的时间。

- **闪电时间**: 当前挖矿周期的持续时间。

  

### 4.3 系统资源监控

底部区域显示当前机器的硬件负载：

- **CPU 使用率**: 整体 CPU 负载。

- **内存占用**: 已用内存 / 总内存。

- **磁盘占用**: 磁盘总使用情况。

- **监控端资源**: 监控端自身占用的 CPU 和内存（通常极低）。

  

## 5. 自动化运行机制 (重要)

  

当您点击“**启动监控**”后，程序将接管部分鼠标控制权。

  

### 5.1 窗口自动调整

程序会自动寻找 Pi 客户端窗口，并强制执行以下操作：

1. **移动窗口**: 将 Pi 客户端移动到屏幕左上角 `(0, 0)` 位置。

2. **调整大小**: 将窗口大小调整为 `600 x 1000` 像素。

> **⚠️ 警告**: 在监控运行期间，**请勿手动移动或缩放 Pi 客户端窗口**，也不要将其最小化，否则会导致 OCR 识别失败。

  

### 5.2 采集流程

程序默认每 **15 分钟** 执行一次采集循环：

1. 检查环境 -> 2. 点击各个菜单项 -> 3. 截图并识别文字 -> 4. 整理数据 -> 5. 上报服务器 -> 6. 休眠等待。

  

在此过程中，您会看到鼠标自动点击 Pi 客户端的各个按钮，这是正常现象。

  

## 6. 长期稳定运行指南

  

对于使用 Windows 远程桌面 (RDP) 管理节点的用户，本节至关重要。

  

### 6.1 远程桌面的问题

当您关闭 RDP 连接窗口时，Windows 会自动锁定当前会话，停止 GPU 渲染。这会导致屏幕变黑，监控端的截图功能失效，从而无法采集数据。

  

### 6.2 解决方案：会话守护模式 (Session Guardian)

为了解决上述问题，我们提供了“会话守护”功能。

  

**使用步骤**:

1. 在监控端顶部栏点击“**会话守护**”。

2. 在弹出的确认窗口中点击“**确认执行**”。

3. **此时您的远程桌面连接会立即断开** —— 这属于正常现象，不要惊慌。

  

**原理**:

程序在后台执行了 `tscon` 命令，将当前的远程会话切换到了本地控制台 (Console) 会话。这意味着：

- Windows 认为有一个“本地用户”正在看着屏幕。

- GPU 渲染保持开启。

- 桌面不会锁定。

- OCR 和自动化操作在后台继续正常运行。

  

**如何重新连接**:

当您需要再次管理服务器时，像往常一样使用远程桌面连接即可。连接后，您会发现之前的程序都在正常运行。

  

### 6.3 虚拟显示驱动 (VDD) 的必要性

  

**如果您使用的是云服务器 (VPS) 或没有连接显示器的物理机，强烈建议安装虚拟显示驱动。**

  

**为什么需要它？**

即使使用了会话守护切换到控制台会话，对于没有连接物理显示器的计算机，显卡可能会认为没有输出设备而停止渲染图像。这会导致 OCR 获取到的是全黑或分辨率极低的画面。

  

**推荐方案**:

我们推荐安装开源的 **Virtual Display Driver (VDD)**。

1. 访问 [Virtual Display Driver GitHub](https://github.com/zagonico86/virtual-display-driver) 下载最新版。

2. 解压并运行安装程序（或手动安装驱动）。

3. 安装完成后，在 Windows 显示设置中，您会看到一个额外的显示器。

4. 将该虚拟显示器的分辨率设置为 **1920x1080** 或更高。

5. 确保 Pi 客户端窗口位于该虚拟显示器上（通常只有一个显示器时会自动处理）。

  

### 6.4 开机自动启动

为了防止服务器重启后监控中断：

1. 点击“**设置**”。

2. 勾选“**开机自动启动**”。

3. 点击“**保存配置**”。

  

## 7. 常见问题 (FAQ)

  

**Q: 启动监控后，Pi 客户端窗口为什么变小了？**

A: 这是正常的。程序强制将窗口调整为 `600x1000` 分辨率以配合 OCR 识别区域。请不要手动拉伸它。

  

**Q: 鼠标不受控制乱动？**

A: 监控端通过模拟鼠标点击来切换 Pi 客户端的页面。建议在专门的服务器上运行，避免在日常使用的电脑上运行，以免干扰您的操作。

  

**Q: 数据一直显示 "-" 或 "0"？**

A:

1. 检查 Pi 客户端版本是否选择正确。

2. 检查 Pi 客户端窗口是否被其他窗口遮挡。

3. 确保显示器未关闭（对于物理机），或已使用“会话守护”（对于远程服务器）。

  

**Q: 提示 "OCR 引擎初始化失败"？**

A: 请确保系统中已安装必要的 VC++ 运行库。如果问题持续，请尝试以管理员身份运行程序。

  

**Q: 日志显示 "心跳失败"？**

A: 请检查网络连接，确保服务器可以访问 `https://api.verkrons.com`。

  

---

© 2025 Verkrons Inc. | Pi Admin Monitor v3.0