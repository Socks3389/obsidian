# 分布式部署方案 (宝塔面板版)

根据您的需求，我们将采用 **3台服务器** 进行分布式部署，并使用宝塔面板进行管理。

## 服务器规划
| 服务器角色   | 最低配置  | 部署内容                  | 说明                  |
| :------ | :---- | :-------------------- | :------------------ |
| **Web** | 2核 4G | 前端静态资源 (Nginx)        | 负责静态页面分发、反向代理、多域名接入 |
| **API** | 4核 8G | 后端服务 (NestJS + PM2)   | 负责业务逻辑、API 处理       |
| **DB**  | 4核 8G | MySQL 8.0 + Redis 7.0 | 负责数据存储，需开启远程访问      |

## 详细部署步骤

### 第一步：数据库服务器（DB）

**目标**：安装数据库并开启远程访问，供 API 连接。

1.  **安装软件**：

    - 登录宝塔面板 -> **软件商店**。

    - 安装 **MySQL 8.0** 和 **Redis 7**

2.  **配置 MySQL 远程访问**：

    - 宝塔 -> **数据库** -> **root密码** (记下密码)。

    - 点击 **权限** (或在“安全”页面放行 3306 端口)。

    - 建议：仅允许 **Server API 的 IP 地址** 访问 3306 端口（更安全），或者为了测试方便暂时允许所有 IP。

    - **导入数据**：将现有服务器的数据库导出为 SQL，在此处导入。

3.  **配置 Redis 远程访问**：

    - 宝塔 -> **软件商店** -> Redis -> **设置**。

    - **配置文件**：找到 `bind 127.0.0.1`，改为 `# bind 127.0.0.1` (注释掉) 或 `bind 0.0.0.0`。

    - **requirepass**：设置一个复杂的密码。

    - **安全**：在宝塔“安全”页面放行 6379 端口。

    - 重启 Redis 服务。